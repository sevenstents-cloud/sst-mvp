{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/eduardo.mendonca/Library/CloudStorage/GoogleDrive-sevenstents%40gmail.com/My%20Drive/Documentos-OneDrive-Mac/marketik.market/Lojinha/VB/MVP_VB_SST_V1/src/lib/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;\nconst supabaseKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!;\n\nif (!supabaseUrl || !supabaseKey) {\n  console.warn('Supabase URL or Key is missing. Please check your .env.local file.');\n}\n\nexport const supabase = createClient(supabaseUrl, supabaseKey);\n"],"names":[],"mappings":";;;;AAEoB;AAFpB;;AAEA,MAAM;AACN,MAAM;AAEN;;AAIO,MAAM,WAAW,IAAA,iMAAY,EAAC,aAAa"}},
    {"offset": {"line": 23, "column": 0}, "map": {"version":3,"sources":["file:///Users/eduardo.mendonca/Library/CloudStorage/GoogleDrive-sevenstents%40gmail.com/My%20Drive/Documentos-OneDrive-Mac/marketik.market/Lojinha/VB/MVP_VB_SST_V1/src/components/layout/ModuleHeader.tsx"],"sourcesContent":["import { LucideIcon } from 'lucide-react';\nimport Link from 'next/link';\n\ninterface ModuleHeaderProps {\n    title: string;\n    subtitle?: string;\n    icon?: LucideIcon;\n    backLink?: string;\n    actionLabel?: string;\n    onAction?: () => void;\n    actionLink?: string;\n}\n\nexport function ModuleHeader({\n    title,\n    subtitle,\n    icon: Icon,\n    backLink,\n    actionLabel,\n    onAction,\n    actionLink\n}: ModuleHeaderProps) {\n    return (\n        <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8 fade-in\">\n            <div className=\"flex items-center gap-4\">\n                {backLink && (\n                    <Link href={backLink} className=\"p-2 rounded-full hover:bg-black/5 dark:hover:bg-white/10 transition-colors\">\n                        <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n                            <path d=\"M19 12H5M12 19l-7-7 7-7\" />\n                        </svg>\n                    </Link>\n                )}\n                {Icon && (\n                    <div className=\"p-3 bg-primary/10 rounded-xl text-primary\">\n                        <Icon size={28} />\n                    </div>\n                )}\n                <div>\n                    <h1 className=\"text-3xl font-bold tracking-tight text-foreground\">{title}</h1>\n                    {subtitle && <p className=\"text-muted-foreground mt-1\">{subtitle}</p>}\n                </div>\n            </div>\n\n            <div className=\"flex gap-2\">\n                {actionLabel && actionLink && (\n                    <Link href={actionLink} className=\"btn btn-primary\">\n                        <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n                            <line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\"></line>\n                            <line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\"></line>\n                        </svg>\n                        {actionLabel}\n                    </Link>\n                )}\n                {actionLabel && onAction && (\n                    <button onClick={onAction} className=\"btn btn-primary\">\n                        <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n                            <line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\"></line>\n                            <line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\"></line>\n                        </svg>\n                        {actionLabel}\n                    </button>\n                )}\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":";;;;;AACA;;;AAYO,SAAS,aAAa,EACzB,KAAK,EACL,QAAQ,EACR,MAAM,IAAI,EACV,QAAQ,EACR,WAAW,EACX,QAAQ,EACR,UAAU,EACM;IAChB,qBACI,6LAAC;QAAI,WAAU;;0BACX,6LAAC;gBAAI,WAAU;;oBACV,0BACG,6LAAC,0KAAI;wBAAC,MAAM;wBAAU,WAAU;kCAC5B,cAAA,6LAAC;4BAAI,OAAM;4BAAK,QAAO;4BAAK,SAAQ;4BAAY,MAAK;4BAAO,QAAO;4BAAe,aAAY;4BAAI,eAAc;4BAAQ,gBAAe;sCACnI,cAAA,6LAAC;gCAAK,GAAE;;;;;;;;;;;;;;;;oBAInB,sBACG,6LAAC;wBAAI,WAAU;kCACX,cAAA,6LAAC;4BAAK,MAAM;;;;;;;;;;;kCAGpB,6LAAC;;0CACG,6LAAC;gCAAG,WAAU;0CAAqD;;;;;;4BAClE,0BAAY,6LAAC;gCAAE,WAAU;0CAA8B;;;;;;;;;;;;;;;;;;0BAIhE,6LAAC;gBAAI,WAAU;;oBACV,eAAe,4BACZ,6LAAC,0KAAI;wBAAC,MAAM;wBAAY,WAAU;;0CAC9B,6LAAC;gCAAI,OAAM;gCAAK,QAAO;gCAAK,SAAQ;gCAAY,MAAK;gCAAO,QAAO;gCAAe,aAAY;gCAAI,eAAc;gCAAQ,gBAAe;;kDACnI,6LAAC;wCAAK,IAAG;wCAAK,IAAG;wCAAI,IAAG;wCAAK,IAAG;;;;;;kDAChC,6LAAC;wCAAK,IAAG;wCAAI,IAAG;wCAAK,IAAG;wCAAK,IAAG;;;;;;;;;;;;4BAEnC;;;;;;;oBAGR,eAAe,0BACZ,6LAAC;wBAAO,SAAS;wBAAU,WAAU;;0CACjC,6LAAC;gCAAI,OAAM;gCAAK,QAAO;gCAAK,SAAQ;gCAAY,MAAK;gCAAO,QAAO;gCAAe,aAAY;gCAAI,eAAc;gCAAQ,gBAAe;;kDACnI,6LAAC;wCAAK,IAAG;wCAAK,IAAG;wCAAI,IAAG;wCAAK,IAAG;;;;;;kDAChC,6LAAC;wCAAK,IAAG;wCAAI,IAAG;wCAAK,IAAG;wCAAK,IAAG;;;;;;;;;;;;4BAEnC;;;;;;;;;;;;;;;;;;;AAMzB;KApDgB"}},
    {"offset": {"line": 231, "column": 0}, "map": {"version":3,"sources":["file:///Users/eduardo.mendonca/Library/CloudStorage/GoogleDrive-sevenstents%40gmail.com/My%20Drive/Documentos-OneDrive-Mac/marketik.market/Lojinha/VB/MVP_VB_SST_V1/src/components/ui/Table.tsx"],"sourcesContent":["import { Action } from \"@radix-ui/react-toast\";\n\ninterface Column<T> {\n    header: string;\n    accessorKey?: keyof T;\n    cell?: (item: T) => React.ReactNode;\n}\n\ninterface TableProps<T> {\n    columns: Column<T>[];\n    data: T[];\n    actions?: (item: T) => React.ReactNode;\n}\n\nexport function Table<T extends { id: string }>({ columns, data, actions }: TableProps<T>) {\n    return (\n        <div className=\"table-container\">\n            <table>\n                <thead>\n                    <tr>\n                        {columns.map((col, idx) => (\n                            <th key={idx}>{col.header}</th>\n                        ))}\n                        {actions && <th className=\"w-24 text-center\">Ações</th>}\n                    </tr>\n                </thead>\n                <tbody>\n                    {data.length === 0 ? (\n                        <tr>\n                            <td colSpan={columns.length + (actions ? 1 : 0)} className=\"text-center py-8 text-muted-foreground\">\n                                Nenhum registro encontrado.\n                            </td>\n                        </tr>\n                    ) : (\n                        data.map((item) => (\n                            <tr key={item.id}>\n                                {columns.map((col, idx) => (\n                                    <td key={idx}>\n                                        {col.cell\n                                            ? col.cell(item)\n                                            : (col.accessorKey ? String(item[col.accessorKey]) : '')}\n                                    </td>\n                                ))}\n                                {actions && (\n                                    <td className=\"text-center\">\n                                        <div className=\"flex items-center justify-center gap-2\">\n                                            {actions(item)}\n                                        </div>\n                                    </td>\n                                )}\n                            </tr>\n                        ))\n                    )}\n                </tbody>\n            </table>\n        </div>\n    );\n}\n"],"names":[],"mappings":";;;;;;AAcO,SAAS,MAAgC,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAiB;IACrF,qBACI,6LAAC;QAAI,WAAU;kBACX,cAAA,6LAAC;;8BACG,6LAAC;8BACG,cAAA,6LAAC;;4BACI,QAAQ,GAAG,CAAC,CAAC,KAAK,oBACf,6LAAC;8CAAc,IAAI,MAAM;mCAAhB;;;;;4BAEZ,yBAAW,6LAAC;gCAAG,WAAU;0CAAmB;;;;;;;;;;;;;;;;;8BAGrD,6LAAC;8BACI,KAAK,MAAM,KAAK,kBACb,6LAAC;kCACG,cAAA,6LAAC;4BAAG,SAAS,QAAQ,MAAM,GAAG,CAAC,UAAU,IAAI,CAAC;4BAAG,WAAU;sCAAyC;;;;;;;;;;+BAKxG,KAAK,GAAG,CAAC,CAAC,qBACN,6LAAC;;gCACI,QAAQ,GAAG,CAAC,CAAC,KAAK,oBACf,6LAAC;kDACI,IAAI,IAAI,GACH,IAAI,IAAI,CAAC,QACR,IAAI,WAAW,GAAG,OAAO,IAAI,CAAC,IAAI,WAAW,CAAC,IAAI;uCAHpD;;;;;gCAMZ,yBACG,6LAAC;oCAAG,WAAU;8CACV,cAAA,6LAAC;wCAAI,WAAU;kDACV,QAAQ;;;;;;;;;;;;2BAXhB,KAAK,EAAE;;;;;;;;;;;;;;;;;;;;;AAsB5C;KA3CgB"}},
    {"offset": {"line": 343, "column": 0}, "map": {"version":3,"sources":["file:///Users/eduardo.mendonca/Library/CloudStorage/GoogleDrive-sevenstents%40gmail.com/My%20Drive/Documentos-OneDrive-Mac/marketik.market/Lojinha/VB/MVP_VB_SST_V1/src/components/pdf/ASODocument.tsx"],"sourcesContent":["import { Document, Page, Text, View, StyleSheet, Image, Font } from '@react-pdf/renderer';\n\n// Register a font (optional, using standard fonts for now for simplicity/speed reliability)\nconst styles = StyleSheet.create({\n    page: {\n        padding: 30,\n        fontFamily: 'Helvetica',\n        fontSize: 10,\n        lineHeight: 1.5,\n    },\n    header: {\n        flexDirection: 'row',\n        borderBottomWidth: 1,\n        borderBottomColor: '#000',\n        paddingBottom: 10,\n        marginBottom: 20,\n        alignItems: 'center',\n        justifyContent: 'space-between',\n    },\n    title: {\n        fontSize: 18,\n        fontWeight: 'bold',\n        textAlign: 'center',\n        textTransform: 'uppercase',\n    },\n    section: {\n        marginBottom: 15,\n        borderWidth: 1,\n        borderColor: '#ccc',\n        padding: 8,\n    },\n    sectionTitle: {\n        fontSize: 11,\n        fontWeight: 'bold',\n        backgroundColor: '#eee',\n        padding: 4,\n        marginBottom: 5,\n    },\n    row: {\n        flexDirection: 'row',\n        marginBottom: 4,\n    },\n    label: {\n        width: 100,\n        fontWeight: 'bold',\n        fontSize: 9,\n        color: '#555',\n    },\n    value: {\n        flex: 1,\n        fontSize: 10,\n    },\n    footer: {\n        position: 'absolute',\n        bottom: 30,\n        left: 30,\n        right: 30,\n        textAlign: 'center',\n        fontSize: 8,\n        color: '#888',\n    },\n    signatureRow: {\n        flexDirection: 'row',\n        justifyContent: 'space-between',\n        marginTop: 50,\n        paddingHorizontal: 20,\n    },\n    signatureBlock: {\n        alignItems: 'center',\n        width: '40%',\n        borderTopWidth: 1,\n        borderTopColor: '#000',\n        paddingTop: 5,\n    },\n});\n\ninterface ASOProps {\n    funcionario: any;\n    empresa: any;\n    exame: any;\n    exameRealizado: any;\n    riscos: any[];\n    medico: any; // Se houver cadastro de médico coordenador\n}\n\nexport const ASODocument = ({ funcionario, empresa, exame, exameRealizado, riscos }: ASOProps) => (\n    <Document>\n        <Page size=\"A4\" style={styles.page}>\n\n            {/* Header */}\n            <View style={styles.header}>\n                <View>\n                    <Text style={styles.title}>Atestado de Saúde Ocupacional</Text>\n                    <Text style={{ fontSize: 12, textAlign: 'center' }}>ASO</Text>\n                </View>\n                <View style={{ alignItems: 'flex-end' }}>\n                    <Text style={{ fontSize: 9 }}>Nr. Controle: {exameRealizado.id.slice(0, 8)}</Text>\n                </View>\n            </View>\n\n            {/* Identificação do Funcionário */}\n            <View style={styles.section}>\n                <Text style={styles.sectionTitle}>1. Identificação do Trabalhador</Text>\n                <View style={styles.row}>\n                    <Text style={styles.label}>Nome:</Text>\n                    <Text style={styles.value}>{funcionario.nome_completo}</Text>\n                </View>\n                <View style={styles.row}>\n                    <Text style={styles.label}>CPF:</Text>\n                    <Text style={styles.value}>{funcionario.cpf}</Text>\n                    <Text style={styles.label}>Data Nasc:</Text>\n                    <Text style={styles.value}>{new Date(funcionario.data_nascimento).toLocaleDateString()}</Text>\n                </View>\n                <View style={styles.row}>\n                    <Text style={styles.label}>Cargo/Função:</Text>\n                    <Text style={styles.value}>{funcionario.cargo?.nome_cargo}</Text>\n                </View>\n                <View style={styles.row}>\n                    <Text style={styles.label}>Setor/GHE:</Text>\n                    <Text style={styles.value}>{funcionario.ghe?.nome_ghe} (Cod: {funcionario.ghe?.codigo_ghe})</Text>\n                </View>\n            </View>\n\n            {/* Identificação da Empresa */}\n            <View style={styles.section}>\n                <Text style={styles.sectionTitle}>2. Identificação da Empresa</Text>\n                <View style={styles.row}>\n                    <Text style={styles.label}>Razão Social:</Text>\n                    <Text style={styles.value}>{empresa.razao_social}</Text>\n                </View>\n                <View style={styles.row}>\n                    <Text style={styles.label}>CNPJ:</Text>\n                    <Text style={styles.value}>{empresa.cnpj}</Text>\n                </View>\n            </View>\n\n            {/* Riscos Ocupacionais */}\n            <View style={styles.section}>\n                <Text style={styles.sectionTitle}>3. Riscos Ocupacionais Específicos</Text>\n                {riscos && riscos.length > 0 ? (\n                    riscos.map((risco, idx) => (\n                        <View key={idx} style={styles.row}>\n                            <Text style={{ width: 80, fontSize: 9 }}>{risco.categoria}:</Text>\n                            <Text style={styles.value}>{risco.nome_agente}</Text>\n                        </View>\n                    ))\n                ) : (\n                    <Text style={{ fontSize: 9, fontStyle: 'italic', padding: 5 }}>Ausência de riscos ocupacionais específicos.</Text>\n                )}\n            </View>\n\n            {/* Procedimentos Médicos */}\n            <View style={styles.section}>\n                <Text style={styles.sectionTitle}>4. Procedimentos Médicos Realizados</Text>\n                <View style={styles.row}>\n                    <Text style={{ width: '50%', fontWeight: 'bold', fontSize: 9 }}>Exame</Text>\n                    <Text style={{ width: '25%', fontWeight: 'bold', fontSize: 9 }}>Data</Text>\n                    <Text style={{ width: '25%', fontWeight: 'bold', fontSize: 9 }}>Resultado</Text>\n                </View>\n                <View style={styles.row}>\n                    <Text style={{ width: '50%', fontSize: 9 }}>{exame.nome_exame} ({exameRealizado.tipo_exame || 'Clínico'})</Text>\n                    <Text style={{ width: '25%', fontSize: 9 }}>{new Date(exameRealizado.data_realizacao).toLocaleDateString()}</Text>\n                    <Text style={{ width: '25%', fontSize: 9 }}>{exameRealizado.resultado || 'Não Informado'}</Text>\n                </View>\n            </View>\n\n            {/* Conclusão */}\n            <View style={{ ...styles.section, marginTop: 10, borderColor: '#000', borderWidth: 2 }}>\n                <Text style={{ ...styles.sectionTitle, backgroundColor: '#ddd', textAlign: 'center', fontSize: 12 }}>5. Conclusão Médica</Text>\n                <View style={{ padding: 10, alignItems: 'center' }}>\n                    <Text style={{ fontSize: 14, fontWeight: 'bold' }}>\n                        {exameRealizado.resultado === 'APTO' ? 'APTO' : 'INAPTO'}\n                    </Text>\n                    <Text style={{ marginTop: 5, fontSize: 10 }}>Para a função específica</Text>\n                </View>\n            </View>\n\n            {/* Assinaturas */}\n            <View style={styles.signatureRow}>\n                <View style={styles.signatureBlock}>\n                    <Text>{exameRealizado.medico_responsavel}</Text>\n                    <Text style={{ fontSize: 8 }}>Médico Examinador</Text>\n                    <Text style={{ fontSize: 8 }}>CRM: {exameRealizado.crm_medico}</Text>\n                </View>\n                <View style={styles.signatureBlock}>\n                    <Text> </Text>\n                    <Text style={{ fontSize: 8 }}>Assinatura do Trabalhador</Text>\n                    <Text style={{ fontSize: 8 }}>{funcionario.nome_completo}</Text>\n                </View>\n            </View>\n\n            <Text style={styles.footer}>\n                Documento gerado eletronicamente pelo Sistema SST Platform em {new Date().toLocaleDateString()}.\n            </Text>\n\n        </Page>\n    </Document>\n);\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1039, "column": 0}, "map": {"version":3,"sources":["file:///Users/eduardo.mendonca/Library/CloudStorage/GoogleDrive-sevenstents%40gmail.com/My%20Drive/Documentos-OneDrive-Mac/marketik.market/Lojinha/VB/MVP_VB_SST_V1/src/app/asos/page.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useState } from 'react';\nimport { supabase } from '@/lib/supabase';\nimport { ModuleHeader } from '@/components/layout/ModuleHeader';\nimport { Table } from '@/components/ui/Table';\nimport { FileCheck, Pencil, Trash2, Download } from 'lucide-react';\nimport Link from 'next/link';\nimport { PDFDownloadLink } from '@react-pdf/renderer';\nimport { ASODocument } from '@/components/pdf/ASODocument';\n\ninterface ExameRealizado {\n    id: string;\n    data_realizacao: string;\n    resultado: string;\n    tipo_exame: string; // Not in DB but useful context if added to protocols or hardcoded\n    funcionario: {\n        id: string;\n        nome_completo: string;\n        cpf: string;\n        data_nascimento: string;\n        cargo: { nome_cargo: string };\n        ghe: { nome_ghe: string; codigo_ghe: string };\n        empresa: { razao_social: string; cnpj: string };\n    };\n    exame: { nome_exame: string };\n    medico_responsavel: string;\n    crm_medico: string;\n}\n\nexport default function ASOsPage() {\n    const [exames, setExames] = useState<ExameRealizado[]>([]);\n    const [loading, setLoading] = useState(true);\n\n    useEffect(() => {\n        fetchExames();\n    }, []);\n\n    async function fetchExames() {\n        setLoading(true);\n\n        // 1. Fetch exames realizados (raw data with foreign keys)\n        const { data: examesRealizadosData, error: examesError } = await supabase\n            .from('exames_realizados')\n            .select(`\n                id, \n                data_realizacao, \n                resultado,\n                medico_responsavel,\n                crm_medico,\n                funcionario_id,\n                exame_id\n            `)\n            .order('data_realizacao', { ascending: false });\n\n        if (examesError) {\n            console.error('Erro ao buscar exames realizados:', JSON.stringify(examesError, null, 2));\n            alert('Erro ao buscar exames: ' + examesError.message);\n            setLoading(false);\n            return;\n        }\n\n        if (!examesRealizadosData || examesRealizadosData.length === 0) {\n            setExames([]);\n            setLoading(false);\n            return;\n        }\n\n        // 2. Extract IDs to fetch related data\n        // @ts-ignore\n        const funcionarioIds = Array.from(new Set(examesRealizadosData.map(e => e.funcionario_id).filter(Boolean)));\n        // @ts-ignore\n        const exameIds = Array.from(new Set(examesRealizadosData.map(e => e.exame_id).filter(Boolean)));\n\n        // 3. Fetch Funcionarios (with their relations)\n        const { data: funcionariosData, error: funcError } = await supabase\n            .from('funcionarios')\n            .select(`\n                id,\n                nome_completo,\n                cpf,\n                data_nascimento,\n                cargo:cargos(nome_cargo),\n                ghe:ghe(nome_ghe, codigo_ghe),\n                empresa:empresas(razao_social, cnpj)\n            `)\n            .in('id', funcionarioIds);\n\n        if (funcError) {\n            console.error('Erro ao buscar detalhes dos funcionários:', funcError);\n        }\n\n        // 4. Fetch Catalogo de Exames\n        const { data: catalogoData, error: catError } = await supabase\n            .from('catalogo_exames')\n            .select('id, nome_exame')\n            .in('id', exameIds);\n\n        if (catError) {\n            console.error('Erro ao buscar detalhes dos exames:', catError);\n        }\n\n        // 5. Manual Join\n        const funcionariosMap = new Map((funcionariosData || []).map((f: any) => [f.id, f]));\n        const catalogoMap = new Map((catalogoData || []).map((c: any) => [c.id, c]));\n\n        const joinedData = examesRealizadosData.map((item: any) => {\n            const func = funcionariosMap.get(item.funcionario_id);\n            const ex = catalogoMap.get(item.exame_id);\n\n            // Safely handle missing relations if any\n            if (!func) return null;\n\n            return {\n                id: item.id,\n                data_realizacao: item.data_realizacao,\n                resultado: item.resultado,\n                medico_responsavel: item.medico_responsavel,\n                crm_medico: item.crm_medico,\n                tipo_exame: '', // Placeholder\n                funcionario: {\n                    id: func.id,\n                    nome_completo: func.nome_completo,\n                    cpf: func.cpf,\n                    data_nascimento: func.data_nascimento,\n                    cargo: func.cargo,\n                    ghe: func.ghe,\n                    empresa: func.empresa\n                },\n                exame: ex ? { nome_exame: ex.nome_exame } : { nome_exame: 'Exame Desconhecido' }\n            };\n        }).filter(Boolean); // Remove items where funcionario was not found\n\n        // @ts-ignore\n        setExames(joinedData);\n        setLoading(false);\n    }\n\n    async function handleDelete(id: string) {\n        if (!confirm('Tem certeza que deseja excluir este registro de exame?')) return;\n\n        const { error } = await supabase\n            .from('exames_realizados')\n            .delete()\n            .eq('id', id);\n\n        if (error) {\n            alert('Erro ao excluir exame');\n        } else {\n            fetchExames();\n        }\n    }\n\n    return (\n        <main className=\"container py-8 fade-in\">\n            <ModuleHeader\n                title=\"Exames Realizados & ASO\"\n                subtitle=\"Emissão de Atestados de Saúde Ocupacional\"\n                icon={FileCheck}\n                backLink=\"/\"\n                actionLabel=\"Registrar Novo Exame\"\n                actionLink=\"/asos/novo\"\n            />\n\n            <div className=\"card\">\n                {loading ? (\n                    <div className=\"p-8 text-center text-muted-foreground\">Carregando...</div>\n                ) : (\n                    <Table\n                        data={exames}\n                        columns={[\n                            { header: 'Funcionário', cell: (item) => item.funcionario?.nome_completo },\n                            { header: 'Exame', cell: (item) => item.exame?.nome_exame },\n                            { header: 'Data', cell: (item) => new Date(item.data_realizacao).toLocaleDateString('pt-BR') },\n                            { header: 'Resultado', accessorKey: 'resultado' },\n                        ]}\n                        actions={(item) => (\n                            <>\n                                <PDFDownloadLink\n                                    document={\n                                        <ASODocument\n                                            funcionario={item.funcionario}\n                                            empresa={item.funcionario.empresa}\n                                            exame={item.exame}\n                                            exameRealizado={item}\n                                            riscos={[]} // Idealmente buscaria os riscos do GHE do funcionário aqui\n                                            medico={null}\n                                        />\n                                    }\n                                    fileName={`ASO_${item.funcionario.nome_completo}_${item.data_realizacao}.pdf`}\n                                    className=\"btn btn-secondary p-2 h-auto\"\n                                >\n                                    <Download size={16} />\n                                </PDFDownloadLink>\n\n                                <Link href={`/asos/${item.id}`} className=\"btn btn-outline p-2 h-auto\" title=\"Editar\">\n                                    <Pencil size={16} />\n                                </Link>\n\n                                <button\n                                    onClick={() => handleDelete(item.id)}\n                                    className=\"btn btn-destructive p-2 h-auto\"\n                                    title=\"Excluir\"\n                                >\n                                    <Trash2 size={16} />\n                                </button>\n                            </>\n                        )}\n                    />\n                )}\n            </div>\n        </main>\n    );\n}\n"],"names":[],"mappings":"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"}}]
}